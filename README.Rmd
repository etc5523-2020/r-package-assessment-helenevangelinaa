---
output: github_document
always_allow_html: true
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```


# covid19shiny

<!-- badges: start -->
[![R build status](https://github.com/etc5523-2020/r-package-assessment-helenevangelinaa/workflows/R-CMD-check/badge.svg)](https://github.com/etc5523-2020/r-package-assessment-helenevangelinaa/actions)
[![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
<!-- badges: end -->

The goal of covid19shiny is to provide users with a shinydashboard created by using `shiny` and `shinydashboard` package, presenting the state of COVID-19 in the world, which is enhanced with user interactions. There are also some functions inside the package. The shiny application could be launched by using `launch_app()` function inside the package. This shinydashboard would allow users to gain insights of COVID-19 state in the world.

List of data inside the package:  
- **covid19wrangled** is the wrangled version of the data taken from `download_merged_data` from [tidycovid19](https://github.com/joachim-gassen/tidycovid19) package   
- **covid19total** presents the summary of COVID-19 cases per country, showing total confirmed cases, total deaths and total recovered cases of a country alongside with other information   
- **worldshp** is a world shape file needed to create a map    

List of functions inside the package:  
- **launch_app** would launch the shiny application showing the state of COVID-19 in the world  
- **selectInput01** would produce the selectInput from `shiny` according to the inputs provided  
- **dailyplot** would create a line graph showing either the daily confirmed cases, daily death, or daily recovered according to the inputs specified. The input `variable_name` would change the y-axis of the line graph to represent the variable  
- **covidtable** would produce a table by using the `DT` package, which is based on the specified dataset

More information regarding the package can be found [here](https://etc5523-2020.github.io/r-package-assessment-helenevangelinaa/index.html).

## Installation

You can install the development version of `covid19shiny` package with:

``` r
# install.packages("devtools")
devtools::install_github("etc5523-2020/r-package-assessment-helenevangelinaa")
```

## Launching the app

This is a basic example on how to launch the shiny dashboard:

``` r
library(covid19shiny)
launch_app()
```

## Usage
The functions inside the package were made to simplify the R codes to create the shiny application, as well as to make it easier for users to produce the plot and table desired.

```{r, include=FALSE}
library(covid19shiny)
library(tibble)
library(dplyr)
library(ggplot2)
library(kableExtra)
library(knitr)
```

Here is an example of how to use the package to generate the dataset:
```r
kable(covid19total)
```

```{r covid19total-table, message=FALSE}
head(covid19total, 10) %>%
  kable()
```

The `selectInput01` function is a function created for the `selectInput` shiny to simplify the code inside the app.R. In order to create a selectInput, user has to specify the **id** and **choices** wanted to be put into the selectInput. Here is an example:
```r
selectInput01("country", covid19total$country)
```
This would create a selectInput of the countries listed in the `covid19total` dataset so that users can choose their desired country to be displayed on the following figures.

The second function, `dailyplot`, will produce a line graph based on the inputs provided. The following code will produce a line graph of the daily confirmed cases of the selected country from the selectInput. The default is **All** which shows the total daily confirmed cases worldwide.
```r
dailyplot(input$country, "confirmed cases", "daily_confirmed")
```

Here is a sample line graph shown in the shiny app which is generated by using `dailyplot` function (this function cannot be produced outside the shinyapp as it is based on the input from selectInput (i.e. input$country)):
```{r line-graph, warning = FALSE, message=FALSE}
dailyall <- covid19wrangled %>%
    group_by(date) %>%
    summarise(totalconfirmed = sum(confirmed),
              totaldeaths = sum(deaths),
              totalrecovered = sum(recovered)) %>%
    mutate(confirmed_lag = lag(totalconfirmed),
           daily_confirmed = totalconfirmed - confirmed_lag,
           death_lag = lag(totaldeaths),
           daily_death = totaldeaths - death_lag,
           recovered_lag = lag(totalrecovered),
           daily_recovered = totalrecovered - recovered_lag)
  
  plot_all <- dailyall %>%
    ggplot(aes_string(x = "date",
               y= "daily_confirmed")) +
    geom_col(fill = "#F09366") +
    geom_line(size = 0, alpha = 0) +
    geom_smooth(color = "red", size = 1) +
    labs(x = "Date",
         y = "Daily number of confirmed cases",
         title = "Figure: Trend of Daily Number of confirmed cases") +
    theme(panel.background = element_rect(fill = "grey16"),
          plot.background = element_rect(fill = "grey16"),
          panel.grid.major = element_blank(),
          panel.grid.minor = element_blank(),
          plot.title = element_text(size = 12), 
          plot.title.position = "plot",
          text = element_text(color = "white"),
          axis.text = element_text(color = "white"),
          axis.line.x = element_line(color = "white",
                                     size = 0.6),
          axis.line.y = element_line(color = "white",
                                     size = 0.6))
  
  
plot_all
```


The third function is the `covidtable` which creates a table by using the `DT` package of the specified dataset. Here is an example of how to use the `covidtable` function, which would result to a table shown below:
```r
covidtable(covid19total)
```

```{r covidtable, echo=FALSE, fig.align='center'}
# adding the figure from COVID-19 Dashboard
knitr::include_graphics("man/figures/covidtable.png")
```

